TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
TPCDS-13,"select i_item_id    ,i_item_desc     ,i_category     ,i_class     ,i_current_price    ,sum(cs_ext_sales_price) as itemrevenue     ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over      (partition by i_class) as revenueratio from    catalog_sales   ,item    ,date_dim where cs_item_sk = i_item_sk   and i_category in ('Jewelry', 'Sports', 'Books')  and cs_sold_date_sk = d_date_sk and d_date between cast('2001-01-12' as date)                  and (cast('2001-01-12' as date) + INTERVAL 30 day) group by i_item_id     ,i_item_desc      ,i_category     ,i_class     ,i_current_price order by i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-48,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand     ,sum(ss_ext_sales_price) ext_price from store_sales   ,date_dim dt   ,item where dt.d_date_sk = store_sales.ss_sold_date_sk   and store_sales.ss_item_sk = item.i_item_sk   and item.i_manager_id = 1   and dt.d_moy=12   and dt.d_year=1998 group by dt.d_year     ,item.i_brand     ,item.i_brand_id order by dt.d_year     ,ext_price desc     ,brand_id limit 100 "
TPCDS-14,"select * from(select w_warehouse_name       ,i_item_id       ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))             then inv_quantity_on_hand            else 0 end) as inv_before       ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))            then inv_quantity_on_hand            else 0 end) as inv_after  from inventory    ,warehouse    ,item    ,date_dim  where i_current_price between 0.99 and 1.49   and i_item_sk     = inv_item_sk   and inv_warehouse_sk  = w_warehouse_sk   and inv_date_sk  = d_date_sk   and d_date between (cast ('1998-04-08' as date) - INTERVAL 30 day)           and (cast ('1998-04-08' as date) + INTERVAL 30 day)  group by w_warehouse_name, i_item_id) x where (case when inv_before > 0       then inv_after / inv_before       else null       end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name     ,i_item_id limit 100"
TPCDS-37,"select dt.d_year     ,item.i_category_id     ,item.i_category     ,sum(ss_ext_sales_price) from  store_sales      ,date_dim dt     ,item where dt.d_date_sk = store_sales.ss_sold_date_sk     and store_sales.ss_item_sk = item.i_item_sk     and item.i_manager_id = 1     and dt.d_moy=12     and dt.d_year=1998 group by     dt.d_year         ,item.i_category_id         ,item.i_category order by    sum(ss_ext_sales_price) desc,dt.d_year         ,item.i_category_id         ,item.i_category limit 100 "
TPCDS-51,"select i_brand_id brand_id, i_brand brand,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item where d_date_sk = ss_sold_date_sk     and ss_item_sk = i_item_sk     and i_manager_id=36     and d_moy=12     and d_year=2001 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100 "
TPCDS-4,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ws_ext_sales_price) as itemrevenue    ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over      (partition by i_class) as revenueratio from         web_sales       ,item       ,date_dim where     ws_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ws_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + INTERVAL 30 day) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio limit 100"
TPCDS-98,"select i_item_id    ,i_item_desc    ,i_category    ,i_class    ,i_current_price    ,sum(ss_ext_sales_price) as itemrevenue    ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over      (partition by i_class) as revenueratio from     store_sales       ,item       ,date_dim where     ss_item_sk = i_item_sk      and i_category in ('Jewelry', 'Sports', 'Books')      and ss_sold_date_sk = d_date_sk     and d_date between cast('2001-01-12' as date)                 and (cast('2001-01-12' as date) + interval 30 days) group by     i_item_id     ,i_item_desc     ,i_category     ,i_class     ,i_current_price order by     i_category     ,i_class     ,i_item_id     ,i_item_desc     ,revenueratio"
TPCDS-91,"select     cc_call_center_id Call_Center,     cc_name Call_Center_Name,     cc_manager Manager,     sum(cr_net_loss) Returns_Loss from     catalog_returns,     call_center,     date_dim,     customer,     customer_address,     customer_demographics,     household_demographics where     cr_call_center_sk    = cc_call_center_sk and   cr_returned_date_sk   = d_date_sk and   cr_returning_customer_sk= c_customer_sk and   cd_demo_sk       = c_current_cdemo_sk and   hd_demo_sk       = c_current_hdemo_sk and   ca_address_sk      = c_current_addr_sk and   d_year         = 1999 and   d_moy          = 11 and   ( (cd_marital_status    = 'M' and cd_education_status   = 'Unknown')     or(cd_marital_status    = 'W' and cd_education_status   = 'Advanced Degree')) and   hd_buy_potential like '0-500%' and   ca_gmt_offset      = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc"
TPCDS-71,"select c_last_name    ,c_first_name    ,c_salutation    ,c_preferred_cust_flag     ,ss_ticket_number    ,cnt from  (select ss_ticket_number      ,ss_customer_sk      ,count(*) cnt   from store_sales,date_dim,store,household_demographics   where store_sales.ss_sold_date_sk = date_dim.d_date_sk   and store_sales.ss_store_sk = store.s_store_sk    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk   and date_dim.d_dom between 1 and 2   and (household_demographics.hd_buy_potential = '>10000' or     household_demographics.hd_buy_potential = 'Unknown')   and household_demographics.hd_vehicle_count > 0   and case when household_demographics.hd_vehicle_count > 0 then        household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1   and date_dim.d_year in (2000,2000+1,2000+2)   and store.s_county in ('Mobile County','Maverick County','Huron County','Kittitas County')   group by ss_ticket_number,ss_customer_sk) dj,customer   where ss_customer_sk = c_customer_sk    and cnt between 1 and 5   order by cnt desc, c_last_name asc"
TPCDS-23,"select dt.d_year     ,item.i_brand_id brand_id     ,item.i_brand brand    ,sum(ss_ext_sales_price) sum_agg from store_sales    ,date_dim dt    ,item where dt.d_date_sk = store_sales.ss_sold_date_sk  and store_sales.ss_item_sk = item.i_item_sk  and item.i_manufact_id = 436  and dt.d_moy=12 group by dt.d_year    ,item.i_brand    ,item.i_brand_id order by dt.d_year     ,sum_agg desc     ,brand_id limit 100"
TPCDS-57,"with ss as ( select      i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_item_id in (select  i_item_id from item where i_category in ('Children')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), cs as ( select      i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_item_id), ws as ( select      i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_category in ('Children')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 9 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_item_id)  select   i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by i_item_id    ,total_sales limit 100"
TPCDS-11,"select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,     sum(ss_ext_sales_price) ext_price from store_sales, date_dim, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk  and ss_item_sk = i_item_sk  and i_manager_id=7  and d_moy=11  and d_year=1999  and ss_customer_sk = c_customer_sk   and c_current_addr_sk = ca_address_sk  and substr(ca_zip,1,5) <> substr(s_zip,1,5)   and ss_store_sk = s_store_sk  group by i_brand    ,i_brand_id    ,i_manufact_id    ,i_manufact order by ext_price desc     ,i_brand     ,i_brand_id     ,i_manufact_id     ,i_manufact limit 100 "
TPCDS-69,"select i_brand_id brand_id, i_brand brand,t_hour,t_minute,     sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price,             ws_sold_date_sk as sold_date_sk,             ws_item_sk as sold_item_sk,             ws_sold_time_sk as time_sk          from web_sales,date_dim         where d_date_sk = ws_sold_date_sk          and d_moy=12          and d_year=2000         union all         select cs_ext_sales_price as ext_price,             cs_sold_date_sk as sold_date_sk,             cs_item_sk as sold_item_sk,             cs_sold_time_sk as time_sk         from catalog_sales,date_dim         where d_date_sk = cs_sold_date_sk          and d_moy=12          and d_year=2000         union all         select ss_ext_sales_price as ext_price,             ss_sold_date_sk as sold_date_sk,             ss_item_sk as sold_item_sk,             ss_sold_time_sk as time_sk         from store_sales,date_dim         where d_date_sk = ss_sold_date_sk          and d_moy=12          and d_year=2000         ) tmp,time_dim where  sold_item_sk = i_item_sk  and i_manager_id=1  and time_sk = t_time_sk  and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id "
TPCDS-78,"select s_store_name    ,sum(ss_net_profit) from store_sales   ,date_dim   ,store,   (select ca_zip   from (    SELECT substr(ca_zip,1,5) ca_zip    FROM customer_address    WHERE substr(ca_zip,1,5) IN (              '89436','30868','65085','22977','83927','77557',              '58429','40697','80614','10502','32779',              '91137','61265','98294','17921','18427',              '21203','59362','87291','84093','21505',              '17184','10866','67898','25797','28055',              '18377','80332','74535','21757','29742',              '90885','29898','17819','40811','25990',              '47513','89531','91068','10391','18846',              '99223','82637','41368','83658','86199',              '81625','26696','89338','88425','32200',              '81427','19053','77471','36610','99823',              '43276','41249','48584','83550','82276',              '18842','78890','14090','38123','40936',              '34425','19850','43286','80072','79188',              '54191','11395','50497','84861','90733',              '21068','57666','37119','25004','57835',              '70067','62878','95806','19303','18840',              '19124','29785','16737','16022','49613',              '89977','68310','60069','98360','48649',              '39050','41793','25002','27413','39736',              '47208','16515','94808','57648','15009',              '80015','42961','63982','21744','71853',              '81087','67468','34175','64008','20261',              '11201','51799','48043','45645','61163',              '48375','36447','57042','21218','41100',              '89951','22745','35851','83326','61125',              '78298','80752','49858','52940','96976',              '63792','11376','53582','18717','90226',              '50530','94203','99447','27670','96577',              '57856','56372','16165','23427','54561',              '28806','44439','22926','30123','61451',              '92397','56979','92309','70873','13355',              '21801','46346','37562','56458','28286',              '47306','99555','69399','26234','47546',              '49661','88601','35943','39936','25632',              '24611','44166','56648','30379','59785',              '11110','14329','93815','52226','71381',              '13842','25612','63294','14664','21077',              '82626','18799','60915','81020','56447',              '76619','11433','13414','42548','92713',              '70467','30884','47484','16072','38936',              '13036','88376','45539','35901','19506',              '65690','73957','71850','49231','14276',              '20005','18384','76615','11635','38177',              '55607','41369','95447','58581','58149',              '91946','33790','76232','75692','95464',              '22246','51061','56692','53121','77209',              '15482','10688','14868','45907','73520',              '72666','25734','17959','24677','66446',              '94627','53535','15560','41967','69297',              '11929','59403','33283','52232','57350',              '43933','40921','36635','10827','71286',              '19736','80619','25251','95042','15526',              '36496','55854','49124','81980','35375',              '49157','63512','28944','14946','36503',              '54010','18767','23969','43905','66979',              '33113','21286','58471','59080','13395',              '79144','70373','67031','38360','26705',              '50906','52406','26066','73146','15884',              '31897','30045','61068','45550','92454',              '13376','14354','19770','22928','97790',              '50723','46081','30202','14410','20223',              '88500','67298','13261','14172','81410',              '93578','83583','46047','94167','82564',              '21156','15799','86709','37931','74703',              '83103','23054','70470','72008','49247',              '91911','69998','20961','70070','63197',              '54853','88191','91830','49521','19454',              '81450','89091','62378','25683','61869',              '51744','36580','85778','36871','48121',              '28810','83712','45486','67393','26935',              '42393','20132','55349','86057','21309',              '80218','10094','11357','48819','39734',              '40758','30432','21204','29467','30214',              '61024','55307','74621','11622','68908',              '33032','52868','99194','99900','84936',              '69036','99149','45013','32895','59004',              '32322','14933','32936','33562','72550',              '27385','58049','58200','16808','21360',              '32961','18586','79307','15492')   intersect    select ca_zip    from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt       FROM customer_address, customer       WHERE ca_address_sk = c_current_addr_sk and          c_preferred_cust_flag='Y'       group by ca_zip       having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk  and ss_sold_date_sk = d_date_sk  and d_qoy = 1 and d_year = 2002  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100"
TPCDS-54,"with ss_items as (select i_item_id item_id     ,sum(ss_ext_sales_price) ss_item_rev  from store_sales   ,item   ,date_dim where ss_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and ss_sold_date_sk  = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id     ,sum(cs_ext_sales_price) cs_item_rev  from catalog_sales    ,item    ,date_dim where cs_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq = (select d_week_seq                    from date_dim                    where d_date = '1998-02-19'))  and cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id     ,sum(ws_ext_sales_price) ws_item_rev  from web_sales    ,item    ,date_dim where ws_item_sk = i_item_sk  and d_date in (select d_date          from date_dim          where d_week_seq =(select d_week_seq                    from date_dim                   where d_date = '1998-02-19'))  and ws_sold_date_sk  = d_date_sk group by i_item_id)  select ss_items.item_id    ,ss_item_rev    ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev    ,cs_item_rev    ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev    ,ws_item_rev    ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev    ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id  and ss_items.item_id=ws_items.item_id   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev  and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev  and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id     ,ss_item_rev limit 100"
TPCDS-52,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where i_item_id in (select   i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8  group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_item_id        in (select  i_item_id from item where i_color in ('orchid','chiffon','lace')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 2000 and   d_moy          = 1 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -8 group by i_item_id)  select i_item_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_item_id order by total_sales,      i_item_id limit 100"
TPCDS-27,"with ss as ( select      i_manufact_id,sum(ss_ext_sales_price) total_sales from     store_sales,     date_dim,     customer_address,     item where     i_manufact_id in (select  i_manufact_id from item where i_category in ('Books')) and   ss_item_sk       = i_item_sk and   ss_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ss_addr_sk       = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), cs as ( select      i_manufact_id,sum(cs_ext_sales_price) total_sales from     catalog_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   cs_item_sk       = i_item_sk and   cs_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   cs_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6  group by i_manufact_id), ws as ( select      i_manufact_id,sum(ws_ext_sales_price) total_sales from     web_sales,     date_dim,     customer_address,     item where     i_manufact_id        in (select  i_manufact_id from item where i_category in ('Books')) and   ws_item_sk       = i_item_sk and   ws_sold_date_sk     = d_date_sk and   d_year         = 1999 and   d_moy          = 3 and   ws_bill_addr_sk     = ca_address_sk and   ca_gmt_offset      = -6 group by i_manufact_id)  select i_manufact_id ,sum(total_sales) total_sales from (select * from ss     union all     select * from cs     union all     select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100"
TPCDS-1,"with customer_total_return as (  select   sr_customer_sk as ctr_customer_sk,   sr_store_sk as ctr_store_sk,   sum(SR_FEE) as ctr_total_return  from   store_returns,   date_dim  where   sr_returned_date_sk = d_date_sk   and d_year = 2000  group by   sr_customer_sk,   sr_store_sk ) select  c_customer_id from  customer_total_return ctr1,  store,  customer where  s_store_sk = ctr1.ctr_store_sk  and s_state = 'NM'  and ctr1.ctr_customer_sk = c_customer_sk order by  c_customer_id limit  100"
TPCDS-49,"select * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from store_sales, item, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in ('Books','Children','Electronics') and i_class in ('personal','portable','reference','self-help') and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',         'exportiunivamalg #9','scholaramalgamalg #9')) or(i_category in ('Women','Music','Men') and i_class in ('accessories','classical','fragrances','pants') and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',         'importoamalg #1'))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales > 0     then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales     else null end > 0.1 order by avg_quarterly_sales,     sum_sales,     i_manufact_id limit 100"
TPCDS-50,"with my_customers as ( select distinct c_customer_sk     , c_current_addr_sk from      ( select cs_sold_date_sk sold_date_sk,         cs_bill_customer_sk customer_sk,         cs_item_sk item_sk      from  catalog_sales      union all      select ws_sold_date_sk sold_date_sk,         ws_bill_customer_sk customer_sk,         ws_item_sk item_sk      from  web_sales     ) cs_or_ws_sales,     item,     date_dim,     customer where  sold_date_sk = d_date_sk     and item_sk = i_item_sk     and i_category = 'Jewelry'     and i_class = 'consignment'     and c_customer_sk = cs_or_ws_sales.customer_sk     and d_moy = 3     and d_year = 1999 ) , my_revenue as ( select c_customer_sk,     sum(ss_ext_sales_price) as revenue from  my_customers,     store_sales,     customer_address,     store,     date_dim where c_current_addr_sk = ca_address_sk     and ca_county = s_county     and ca_state = s_state     and ss_sold_date_sk = d_date_sk     and c_customer_sk = ss_customer_sk     and d_month_seq between (select distinct d_month_seq+1                 from  date_dim where d_year = 1999 and d_moy = 3)              and (select distinct d_month_seq+3                 from  date_dim where d_year = 1999 and d_moy = 3) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment  from  my_revenue )  select segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100"
TPCDS-60,"select * from (select i_manager_id       ,sum(ss_sales_price) sum_sales       ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales    from store_sales      ,item      ,date_dim      ,store    where ss_item_sk = i_item_sk     and ss_sold_date_sk = d_date_sk     and ss_store_sk = s_store_sk     and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11)     and ((  i_category in ('Books','Children','Electronics')        and i_class in ('personal','portable','reference','self-help')        and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',                  'exportiunivamalg #9','scholaramalgamalg #9'))      or(  i_category in ('Women','Music','Men')        and i_class in ('accessories','classical','fragrances','pants')        and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',                 'importoamalg #1'))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by i_manager_id     ,avg_monthly_sales     ,sum_sales limit 100"
TPCDS-65,"select c_last_name    ,c_first_name    ,ca_city    ,bought_city    ,ss_ticket_number    ,extended_price    ,extended_tax    ,list_price from (select ss_ticket_number       ,ss_customer_sk       ,ca_city bought_city       ,sum(ss_ext_sales_price) extended_price        ,sum(ss_ext_list_price) list_price       ,sum(ss_ext_tax) extended_tax     from store_sales      ,date_dim      ,store      ,household_demographics      ,customer_address     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and date_dim.d_dom between 1 and 2     and (household_demographics.hd_dep_count = 2 or       household_demographics.hd_vehicle_count= 1)     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_city in ('Cedar Grove','Wildwood')    group by ss_ticket_number        ,ss_customer_sk        ,ss_addr_sk,ca_city) dn    ,customer    ,customer_address current_addr where ss_customer_sk = c_customer_sk  and customer.c_current_addr_sk = current_addr.ca_address_sk  and current_addr.ca_city <> bought_city order by c_last_name     ,ss_ticket_number limit 100"
